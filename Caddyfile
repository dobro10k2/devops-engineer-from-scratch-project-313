{
    admin off
    auto_https off
}

:80

encode gzip

# Health checks
handle /health {
    respond 200
}
handle /ping {
    respond "pong" 200
}

# API
handle_path /api/* {
    reverse_proxy 127.0.0.1:8080 {
        header_up X-Real-IP {remote}
    }
}

# Short links
handle_path /r/* {
    reverse_proxy 127.0.0.1:8080
}

# SPA
handle {
    reverse_proxy 127.0.0.1:5173 {
        header_up X-Real-IP {remote}
    }
}
